<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sistema de Whitelist de Proyecto Roleplay</title>
<style>
  :root{
    --bg:#0b0f14;
    --panel:#111b28;
    --panel-2:#122033;

    --muted:#a4b5c6;
    --text:#ffffff;

    --grad1:#885efc;
    --grad2:#5edae7;
    --grad3:#70a4f0;
    --grad4:#7b84f5;

    --alpha-header-1:.14;
    --alpha-header-2:.12;
    --alpha-section-1:.08;
    --alpha-section-2:.06;

    --radius:16px;
    --shadow:0 10px 30px rgba(0,0,0,.30);
  }
  *{box-sizing:border-box}
  html,body{
    height:100%; margin:0;
    background:
      radial-gradient(1200px 500px at -20% -20%, color-mix(in srgb, var(--grad1) calc(var(--alpha-header-1)*100%), transparent), transparent 60%),
      radial-gradient(1200px 500px at 120% -30%,  color-mix(in srgb, var(--grad2) calc(var(--alpha-header-2)*100%), transparent), transparent 60%),
      var(--bg);
    color:var(--text);
    font:500 16px/1.5 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
  }
  .wrap{min-height:100%;padding:20px;display:grid;place-items:center}
  .card{
    /* ↓ Reducido un cuarto (1100px → 825px) */
    width:min(825px,100%);
    background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015)) , var(--panel);
    border:1px solid rgba(255,255,255,.08);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
  }

  header{
    display:flex;justify-content:space-between;align-items:center;gap:16px;
    padding:18px 22px;border-bottom:1px solid rgba(255,255,255,.08);
    background:
      linear-gradient(120deg,
        color-mix(in srgb, var(--grad1) calc(var(--alpha-header-1)*100%), transparent),
        color-mix(in srgb, var(--grad2) calc(var(--alpha-header-2)*100%), transparent) 40%,
        color-mix(in srgb, var(--grad3) calc(var(--alpha-header-2)*100%), transparent) 70%,
        color-mix(in srgb, var(--grad4) calc(var(--alpha-header-1)*100%), transparent) 100%);
  }
  .brand{display:flex;align-items:center;gap:14px}
  .logo{
    /* ↓ Logo un poco más grande */
    width:96px;height:96px;border-radius:14px;object-fit:cover;
    background:transparent;border:none;box-shadow:none;
  }
  .title{font-size:18px;font-weight:900;letter-spacing:.3px}
  .muted{color:var(--muted);font-weight:600;font-size:14px}
  #statusTag{display:none}

  .content{padding:18px 18px 20px}
  .grid{display:grid;grid-template-columns:1fr 1.1fr;gap:16px}
  @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

  .section{
    background:
      linear-gradient(135deg,
        color-mix(in srgb, var(--grad1) calc(var(--alpha-section-1)*100%), transparent),
        color-mix(in srgb, var(--grad2) calc(var(--alpha-section-2)*100%), transparent) 35%,
        color-mix(in srgb, var(--grad3) calc(var(--alpha-section-2)*100%), transparent) 70%,
        color-mix(in srgb, var(--grad4) calc(var(--alpha-section-1)*100%), transparent) 100%),
      var(--panel-2);
    border:1px solid rgba(255,255,255,.08);
    border-radius:14px;padding:14px;
  }
  h3{
    margin:0 0 8px;font-size:16px;
    background-image: linear-gradient(90deg, var(--grad1), var(--grad2), var(--grad3), var(--grad4));
    -webkit-background-clip: text; background-clip: text; color: transparent;
  }
  .t-center{text-align:center;}

  .field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
  .label{font-size:13px;color:var(--muted);font-weight:800;letter-spacing:.25px}
  .input,.select,textarea{
    background:#0f1a28;color:var(--text);border:1px solid rgba(255,255,255,.10);
    border-radius:10px;padding:10px 12px;outline:none;
    transition:border .15s ease,box-shadow .15s ease;
  }
  .input::placeholder, textarea::placeholder{color:transparent}
  .input:focus,.select:focus,textarea:focus{
    border-color:rgba(112,164,240,.7);box-shadow:0 0 0 3px rgba(112,164,240,.20)
  }

  .progress{display:flex;align-items:center;gap:8px;margin:6px 0 12px}
  .bar{flex:1;height:8px;background:#0d141c;border:1px solid rgba(255,255,255,.08);border-radius:999px;overflow:hidden}
  .bar>span{display:block;height:100%;
    background: linear-gradient(90deg, var(--grad1), var(--grad2), var(--grad3), var(--grad4));
    width:0%}
  .pill{font-size:12px;color:var(--muted);background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.10);border-radius:999px;padding:4px 8px}

  .q-wrap{display:flex;flex-direction:column;gap:10px}
  .q-block{border:1px solid rgba(255,255,255,.10);border-radius:12px;overflow:hidden}
  .q-head{
    background:rgba(255,255,255,.03);padding:10px 12px;font-weight:900;
    background-image: linear-gradient(90deg, var(--grad1), var(--grad2), var(--grad3), var(--grad4));
    -webkit-background-clip: text; background-clip: text; color: transparent;
  }
  .q-body{padding:10px 12px;display:flex;flex-direction:column;gap:8px}
  label.option{
    display:flex;gap:10px;align-items:flex-start;background:#0e1520;border:1px solid rgba(255,255,255,.09);
    border-radius:10px;padding:10px 12px;cursor:pointer;transition:border .15s ease, box-shadow .15s ease
  }
  label.option:hover{border-color:rgba(112,164,240,.6);box-shadow:0 0 0 3px rgba(112,164,240,.18)}

  .controls{display:flex;gap:8px;justify-content:center;align-items:center;margin-top:10px;flex-wrap:wrap}
  .btn{border:1px solid rgba(255,255,255,.12);border-radius:11px;padding:10px 14px;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));color:var(--text);font-weight:800;cursor:pointer;user-select:none}
  .btn[disabled]{opacity:.55;cursor:not-allowed}
  .btn-primary{background:linear-gradient(180deg,var(--grad3), var(--grad4));color:#0b0f14;border-color:transparent}
  .btn-success{background:linear-gradient(180deg,var(--grad2), var(--grad3));color:#0b0f14;border-color:transparent}

  .note{font-size:13px;color:var(--muted)}
  .summary{display:grid;grid-template-columns:1fr;gap:12px}
  .kv{display:grid;grid-template-columns:160px 1fr;gap:10px;align-items:center}
  @media (max-width:640px){ .kv{grid-template-columns:1fr} }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <header>
      <div class="brand">
        <img class="logo" src="https://i.postimg.cc/C1Fx25qp/dfgdsg-Photoroom.png" alt="Logo Proyecto Roleplay"/>
        <div>
          <div class="title">Sistema de Whitelist de Proyecto Roleplay</div>
          <div class="muted">Recomendamos a todos los usuarios leer detenidamente tanto las preguntas como las respuestas.</div>
          <div class="muted">No asuman información que no está escrita.</div>
        </div>
      </div>
      <div class="muted" id="statusTag"></div>
    </header>

    <div class="content">
      <!-- PASO 1 -->
      <div class="grid" id="step1">
        <div class="section">
          <h3 class="t-center">Datos del jugador</h3>
          <div class="field">
            <label class="label" for="discord">Nombre de Discord</label>
            <input class="input" id="discord"/>
          </div>
          <div class="field">
            <label class="label" for="edad">Edad</label>
            <input class="input" id="edad" type="number" min="14" max="99"/>
          </div>
          <div class="field">
            <label class="label" for="region">País/Región</label>
            <input class="input" id="region"/>
          </div>
          <div class="field">
            <label class="label" for="conoces">¿Cómo nos conociste?</label>
            <input class="input" id="conoces"/>
          </div>
          <div class="field">
            <label class="label" for="exp">Experiencia en RP</label>
            <textarea id="exp"></textarea>
          </div>
        </div>

        <div class="section">
          <h3>Progreso</h3>
          <div class="progress">
            <div class="bar"><span id="bar"></span></div>
            <span class="pill" id="pill">0%</span>
          </div>
          <div class="controls">
            <button class="btn btn-primary" id="startBtn">Empezar test</button>
          </div>
        </div>
      </div>

      <!-- PASO 2 -->
      <div id="step2" style="display:none">
        <div class="section">
          <div class="controls" style="margin-bottom:8px">
            <span class="pill" id="catPill">—</span>
            <span class="note" id="qIndex">Pregunta 1 de N</span>
          </div>
          <div class="q-wrap">
            <div class="q-block">
              <div class="q-head" id="qTitle">Pregunta</div>
              <div class="q-body" id="qBody"></div>
            </div>
          </div>
          <div class="controls">
            <button class="btn" id="prevBtn">Anterior</button>
            <button class="btn" id="omitBtn">Omitir</button>
            <button class="btn btn-primary" id="nextBtn" disabled>Siguiente</button>
          </div>
        </div>
      </div>

      <!-- PASO 3 -->
      <div id="step3" style="display:none">
        <div class="section">
          <h3>Resumen</h3>
          <div class="summary">
            <div class="kv"><div class="label">Discord</div><div id="sDiscord">—</div></div>
            <div class="kv"><div class="label">Edad</div><div id="sEdad">—</div></div>
            <div class="kv"><div class="label">Región</div><div id="sRegion">—</div></div>
            <div class="kv"><div class="label">Nos conociste por</div><div id="sConoces">—</div></div>
            <div class="kv"><div class="label">Experiencia</div><div id="sExp">—</div></div>
            <div class="kv"><div class="label">Puntuación</div><div id="sScore">—</div></div>
          </div>
          <div class="controls" style="margin-top:12px">
            <button class="btn" id="backToTest">Volver al test</button>
            <button class="btn btn-success" id="sendBtn">Enviar whitelist</button>
          </div>
          <p class="note" id="sendNote">Los datos se enviarán al staff mediante Webhook.</p>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
/* (Añadiremos luego tus 10 preguntas con variantes) */
const QUESTIONS = [];
const webhookURL = "/discord/api/webhooks/1385716193066745997/ZoQ-DRAkE9ilPSQZQ23gU1b6uT3U_tMQ8Qcpmgx_2AvyrG8c1Ey75iAVeWKJ4wcKky-e";

const state = { step: 1, i: 0, answers: [] };
const $ = s=>document.querySelector(s);
const bar = $("#bar"), pill=$("#pill");

function setProgress(p){ bar.style.width = p + "%"; pill.textContent = Math.round(p)+"%"; }
function showStep(n){ state.step=n; $("#step1").style.display=n===1?"block":"none"; $("#step2").style.display=n===2?"block":"none"; $("#step3").style.display=n===3?"block":"none"; }

function startTest(){
  if(!$("#discord").value.trim()){ alert("Pon tu nombre de Discord."); return; }
  setProgress(5); showStep(2); state.i=0; renderQ();
}
function renderQ(){
  const q = QUESTIONS[state.i] || {question:"(Aún sin preguntas definidas)", answers:[{text:"Ejemplo",isCorrect:true}]};
  $("#qTitle").textContent = q.question;
  $("#catPill").textContent = q.category || "—";
  $("#qIndex").textContent = "Pregunta " + (state.i+1) + " de " + (QUESTIONS.length||1);

  const body = $("#qBody"); body.innerHTML="";
  const multi = q.answers.filter(a=>a.isCorrect).length>1;
  q.answers.forEach((a,idx)=>{
    const lab=document.createElement("label"); lab.className="option";
    const input=document.createElement("input");
    input.type=multi?"checkbox":"radio"; input.name="q"; input.value=idx;
    input.addEventListener("change",()=>{ $("#nextBtn").disabled = body.querySelectorAll("input:checked").length===0; });
    const span=document.createElement("span"); span.textContent=a.text;
    lab.appendChild(input); lab.appendChild(span); body.appendChild(lab);
  });

  $("#nextBtn").disabled=true;
  setProgress(5+(state.i/Math.max(1,QUESTIONS.length))*85);
}
function collectCurrentAnswer(omit=false){
  const q = QUESTIONS[state.i]; if(!q) return;
  const body=$("#qBody");
  const sel=[...body.querySelectorAll("input:checked")].map(i=>Number(i.value));
  const correctSet=new Set(q.answers.map((a,i)=>a.isCorrect?i:null).filter(i=>i!==null));
  const chosenSet=new Set(sel); let correct=true;
  if(!omit){
    for(const i of chosenSet) if(!correctSet.has(i)) correct=false;
    if(correct) for(const i of correctSet) if(!chosenSet.has(i)) correct=false;
  } else correct=false;
  state.answers[state.i]={ index: state.i, chosen: omit?[]:sel, correct };
}
function next(){ collectCurrentAnswer(false); if(state.i < (QUESTIONS.length-1)){ state.i++; renderQ(); } else { showSummary(); } }
function omit(){ collectCurrentAnswer(true); if(state.i < (QUESTIONS.length-1)){ state.i++; renderQ(); } else { showSummary(); } }
function prev(){ if(state.i===0) return; state.i--; renderQ(); const s=state.answers[state.i]; if(s&&s.chosen){ s.chosen.forEach(v=>{ const i=$("#qBody").querySelector(`input[value="${v}"]`); if(i) i.checked=true; }); $("#nextBtn").disabled=s.chosen.length===0; } }

function showSummary(){
  const score = state.answers.reduce((a,b)=> a + (b && b.correct ? 1 : 0), 0);
  $("#sDiscord").textContent=$("#discord").value||"—";
  $("#sEdad").textContent=$("#edad").value||"—";
  $("#sRegion").textContent=$("#region").value||"—";
  $("#sConoces").textContent=$("#conoces").value||"—";
  $("#sExp").textContent=$("#exp").value||"—";
  $("#sScore").textContent= score + " / " + (QUESTIONS.length||0);
  setProgress(100); showStep(3);
}

async function send(){
  const score = state.answers.reduce((a,b)=> a + (b && b.correct ? 1 : 0), 0);
  const body = {
    username:"Whitelist",
    embeds:[{
      title:"Nueva solicitud de Whitelist",
      color: 0x70a4f0,
      description: ($("#exp").value || "Sin experiencia"),
      fields:[
        { name:"Discord", value: $("#discord").value||"—", inline:true },
        { name:"Edad", value: $("#edad").value||"—", inline:true },
        { name:"Región", value: $("#region").value||"—", inline:true },
        { name:"Conociste por", value: $("#conoces").value||"—", inline:true },
        { name:"Puntuación", value: String(score), inline:true }
      ],
      footer:{ text:"Enviado desde Activity de Discord" },
      timestamp:new Date().toISOString()
    }]
  };
  try{
    $("#sendNote").textContent="Enviando…";
    const r=await fetch(webhookURL,{ method:"POST", headers:{ "Content-Type":"application/json" }, body:JSON.stringify(body) });
    if(!r.ok) throw new Error("HTTP "+r.status);
    $("#sendNote").textContent="¡Enviado! El staff revisará tu solicitud.";
  }catch(e){
    $("#sendNote").textContent="Error al enviar. Revisa consola."; console.error(e);
  }
}

$("#startBtn").addEventListener("click", startTest);
$("#nextBtn").addEventListener("click", next);
$("#omitBtn").addEventListener("click", omit);
$("#prevBtn").addEventListener("click", prev);
$("#backToTest").addEventListener("click", ()=> showStep(2));
$("#sendBtn").addEventListener("click", send);

showStep(1); setProgress(0);
</script>
</body>
</html>

